<script type="text/javascript" charset="utf-8">
  $(document).ready(function(){
    var parameters = {
      poster: "<%= (@stream.live ? '/preview/' + @stream.user.username + '.jpg' : @stream.placeholder_url) %>",
      src: "rtmp://<%= Settings.rtmp.server %>/stream/<%= @stream.user.username %>",
      autoPlay: <%= (@stream.live ? 'true' : 'false') %>,
      controlBarAutoHide: true,
      controlBarAutoHideTimeout: 1,
      playButtonOverlay: false,
      optimizeBuffering : false,
      optimizeInitialIndex: false,
      streamType: "live",
      javascriptCallbackFunction: "createJSBridge",
    };
    swfobject.embedSWF(
      "/StrobeMediaPlayback.swf",
      "player",
      770,
      433,
      "10.1.0",
      "/expressInstall.swf",
      parameters,
      { allowFullScreen: "true", allowScriptAccess: 'always', wmode: 'opaque' },
      { name: "player" }
    );
  });
  var player = null;
  function createJSBridge(id) {
    if (player == null) {
      player = document.getElementById(id);
    }
  }
  
</script>